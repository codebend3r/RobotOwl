<html>
<head>
  <title>Evernote Export</title>
  <basefont face="Tahoma" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/271108 (en-US); Windows/6.3.9600;"/>
  <style>
    body, td {
      font-family: Tahoma;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="882"/>

<div>
<div style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><div style="font-size: 16px;"><p style="margin: 0px; padding: 0px; color: rgb(51, 51, 51); font-family: Arial, sans-serif; font-size: 14px; line-height: 20px; background-color: rgb(255, 255, 255);"><em>Prerequisites</em><em>: </em></p><ul style="margin: 10px 0px 0px; color: rgb(51, 51, 51); font-family: Arial, sans-serif; font-size: 14px; line-height: 20px; background-color: rgb(255, 255, 255);"><li><em>If you don't have an Angular scaffold already created, follow the instructions <a href="http://rd-confluence.rd.local/display/RD/2014/04/01/Creating+a+Quick+Angular+App+via+Yeoman" rel="nofollow" style="color: rgb(59, 115, 175); text-decoration: none;">here</a> to set that up.</em></li><li><em>Grunt</em></li><li><em>NPM</em></li><li><em>Karma</em></li></ul><h2 style="margin: 30px 0px 0px; padding: 0px; font-size: 20px; font-weight: normal; line-height: 1.5; color: rgb(51, 51, 51); border-bottom-color: rgb(204, 204, 204); font-family: Arial, sans-serif; background-color: rgb(255, 255, 255);">Getting Started</h2><p style="margin: 10px 0px 0px; padding: 0px; color: rgb(51, 51, 51); font-family: Arial, sans-serif; font-size: 14px; line-height: 20px; background-color: rgb(255, 255, 255);">Now that we finally have an Angular project working. Let's check that karma is installed and working with the default test that comes with the yo angular scaffold. Unfortunately yo angular doesn't install everything we need to run karma. So we need to install jasmine and at least one browser launcher.</p><pre style="margin-top: 10px; margin-bottom: 0px; padding: 0px; color: rgb(51, 51, 51); font-size: 14px; line-height: 20px; background-color: rgb(255, 255, 255);">
npm install karma-jasmine --save-dev<br/>npm install karma-phantomjs-launcher --save-dev<br/>npm install karma-chrome-launcher --save-dev
</pre><p style="margin: 10px 0px 0px; padding: 0px; color: rgb(51, 51, 51); font-family: Arial, sans-serif; font-size: 14px; line-height: 20px; background-color: rgb(255, 255, 255);">Edit your <strong><em>karma.conf.js</em></strong> file to run PhantomJS instead of Chrome. This is optional and you can leave it as Chrome. This is just to show we don't need a browser window visually opening up to run a unit test.</p><p style="margin: 10px 0px 0px; padding: 0px; color: rgb(51, 51, 51); font-family: Arial, sans-serif; font-size: 14px; line-height: 20px; background-color: rgb(255, 255, 255);">Line 49 change to the following:</p><pre style="margin-top: 10px; margin-bottom: 0px; padding: 0px; color: rgb(51, 51, 51); font-size: 14px; line-height: 20px; background-color: rgb(255, 255, 255);">
browsers: ['PhantomJS'],
</pre><p style="margin: 10px 0px 0px; padding: 0px; color: rgb(51, 51, 51); font-family: Arial, sans-serif; font-size: 14px; line-height: 20px; background-color: rgb(255, 255, 255);">Your config should now look like this: <a href="http://confluence/download/attachments/21957797/karma.conf.js?version=1&amp;modificationDate=1396377136000&amp;api=v2" style="color: rgb(59, 115, 175); text-decoration: none;">karma.conf.js</a></p><p style="margin: 10px 0px 0px; padding: 0px; color: rgb(51, 51, 51); font-family: Arial, sans-serif; font-size: 14px; line-height: 20px; background-color: rgb(255, 255, 255);">Run command:</p><pre style="margin-top: 10px; margin-bottom: 0px; padding: 0px; color: rgb(51, 51, 51); font-size: 14px; line-height: 20px; background-color: rgb(255, 255, 255);">
grunt karma
</pre><p style="margin: 10px 0px 0px; padding: 0px; color: rgb(51, 51, 51); font-family: Arial, sans-serif; font-size: 14px; line-height: 20px; background-color: rgb(255, 255, 255);">You should see 1 test pass.</p><h2 style="margin: 30px 0px 0px; padding: 0px; font-size: 20px; font-weight: normal; line-height: 1.5; color: rgb(51, 51, 51); border-bottom-color: rgb(204, 204, 204); font-family: Arial, sans-serif; background-color: rgb(255, 255, 255);">Custom Test Suite</h2><p style="margin: 10px 0px 0px; padding: 0px; color: rgb(51, 51, 51); font-family: Arial, sans-serif; font-size: 14px; line-height: 20px; background-color: rgb(255, 255, 255);">This is all great. We have angular running and we can now run a create a unit test but let's make a useful test.</p><p style="margin: 10px 0px 0px; padding: 0px; color: rgb(51, 51, 51); font-family: Arial, sans-serif; font-size: 14px; line-height: 20px; background-color: rgb(255, 255, 255);">Edit <a href="http://confluence/download/attachments/21957797/app.js?version=1&amp;modificationDate=1396377136000&amp;api=v2" style="color: rgb(59, 115, 175); text-decoration: none;">app/scripts/</a><a href="http://confluence/download/attachments/21957797/app.js?version=1&amp;modificationDate=1396377136000&amp;api=v2" style="color: rgb(59, 115, 175); text-decoration: none;">app.js</a> and <a href="http://confluence/download/attachments/21957797/main.js?version=6&amp;modificationDate=1396377136000&amp;api=v2" style="color: rgb(59, 115, 175); text-decoration: none;">app/scripts/</a><a href="http://confluence/download/attachments/21957797/main.js?version=6&amp;modificationDate=1396377136000&amp;api=v2" style="color: rgb(59, 115, 175); text-decoration: none;">controllers/</a><a href="http://confluence/download/attachments/21957797/main.js?version=6&amp;modificationDate=1396377136000&amp;api=v2" style="color: rgb(59, 115, 175); text-decoration: none;">main.js</a> respectively.</p><p style="margin: 10px 0px 0px; padding: 0px; color: rgb(51, 51, 51); font-family: Arial, sans-serif; font-size: 14px; line-height: 20px; background-color: rgb(255, 255, 255);">Edit your test spec: <a href="http://confluence/download/attachments/21957797/mainspec.js?version=2&amp;modificationDate=1396377717000&amp;api=v2" style="color: rgb(59, 115, 175); text-decoration: none;">test/spec/controller/mainspec.js</a></p><p style="margin: 10px 0px 0px; padding: 0px; color: rgb(51, 51, 51); font-family: Arial, sans-serif; font-size: 14px; line-height: 20px; background-color: rgb(255, 255, 255);">We write the test in the Jasmine framework. Jasmine has a few built global functions: <em>describe, beforeEach, inject, it, expect</em>. For more see here: <a href="http://jasmine.github.io/2.0/introduction.html" rel="nofollow" style="color: rgb(59, 115, 175); text-decoration: none;">Jasmine Reference</a>.</p><p style="margin: 10px 0px 0px; padding: 0px; color: rgb(51, 51, 51); font-family: Arial, sans-serif; font-size: 14px; line-height: 20px; background-color: rgb(255, 255, 255);">Within every describe function you need to define a few things to test Angular controllers:</p><ul style="margin: 10px 0px 0px; color: rgb(51, 51, 51); font-family: Arial, sans-serif; font-size: 14px; line-height: 20px; background-color: rgb(255, 255, 255);"><li>the main angular module</li><li>the corresponding controller (Login Controller)</li><li>scope to that controller</li><li>any other dependencies (usersList) that the suite needs to work.</li></ul><pre style="margin-top: 10px; margin-bottom: 0px; padding: 0px; color: rgb(51, 51, 51); font-size: 14px; line-height: 20px; background-color: rgb(255, 255, 255);">
beforeEach(module('angularTestApp')); // the module
</pre><pre style="margin-top: 10px; margin-bottom: 0px; padding: 0px; color: rgb(51, 51, 51); font-size: 14px; line-height: 20px; background-color: rgb(255, 255, 255);">
var LoginCtrl,<br/>    scope,<br/>    user;
</pre><pre style="margin-top: 10px; margin-bottom: 0px; padding: 0px; color: rgb(51, 51, 51); font-size: 14px; line-height: 20px; background-color: rgb(255, 255, 255);">
// save a reference to the controller, scope and user
</pre><pre style="margin-top: 10px; margin-bottom: 0px; padding: 0px; color: rgb(51, 51, 51); font-size: 14px; line-height: 20px; background-color: rgb(255, 255, 255);">
beforeEach(inject(function ($controller, $rootScope, usersList) { // inject what we need as parameters.<br/>    scope = $rootScope.$new(); // instantiate new scope<br/>    user = usersList; // custom dependency<br/>    LoginCtrl = $controller('LoginCtrl', { // reference to login controller
</pre><pre style="margin-top: 10px; margin-bottom: 0px; padding: 0px; color: rgb(51, 51, 51); font-size: 14px; line-height: 20px; background-color: rgb(255, 255, 255);">
        $scope: scope // save new scope to login controller<br/>    });<br/>}));
</pre><p style="margin: 10px 0px 0px; padding: 0px; color: rgb(51, 51, 51); font-family: Arial, sans-serif; font-size: 14px; line-height: 20px; background-color: rgb(255, 255, 255);">Here is a spec in it's simplest form. The LoginCtrl has a function called hello which returns a string. We expect the hello function to return &quot;oh hello !&quot;</p><pre style="margin-top: 10px; margin-bottom: 0px; padding: 0px; color: rgb(51, 51, 51); font-size: 14px; line-height: 20px; background-color: rgb(255, 255, 255);">
it('should return oh hello!', function () {<br/>    expect(scope.hello()).toBe('oh hello!');<br/>});
</pre><p style="margin: 10px 0px 0px; padding: 0px; color: rgb(51, 51, 51); font-family: Arial, sans-serif; font-size: 14px; line-height: 20px; background-color: rgb(255, 255, 255);">A more complicated spec. We select a random user object from the saved reference to userList. Then set that as the credentials object. Then execute the login() function and expect it to return true.</p><pre style="margin-top: 10px; margin-bottom: 0px; padding: 0px; color: rgb(51, 51, 51); font-size: 14px; line-height: 20px; background-color: rgb(255, 255, 255);">
it('return true if dynamic username matches password', function () {<br/>    var n = Math.ceil(Math.random() * user.length - 1),<br/>        randomUser = user[n];<br/>    scope.credentials = randomUser;<br/>    expect(scope.login()).toBe(true);<br/>});
</pre><p style="margin: 10px 0px 0px; padding: 0px; color: rgb(51, 51, 51); font-family: Arial, sans-serif; font-size: 14px; line-height: 20px; background-color: rgb(255, 255, 255);">Now we can run grunt karma and hopefully all 6 tests pass. Click <a href="https://github.com/crivas/AngularTest" rel="nofollow" style="color: rgb(59, 115, 175); text-decoration: none;">HERE</a> to view download the entire project on Git in case I missed anything.</p><p style="margin: 10px 0px 0px; padding: 0px; color: rgb(51, 51, 51); font-family: Arial, sans-serif; font-size: 14px; line-height: 20px; background-color: rgb(255, 255, 255);"> </p><h2 style="margin: 30px 0px 0px; padding: 0px; font-size: 20px; font-weight: normal; line-height: 1.5; color: rgb(51, 51, 51); border-bottom-color: rgb(204, 204, 204); font-family: Arial, sans-serif; background-color: rgb(255, 255, 255);">Installation Summary</h2><pre style="margin-top: 10px; margin-bottom: 0px; padding: 0px; color: rgb(51, 51, 51); font-size: 14px; line-height: 20px; background-color: rgb(255, 255, 255);">
npm install

bower install

npm install -g karma

npm install grunt --save-dev
npm install -g grunt-cli

npm install karma-jasmine --save-dev
npm install karma-phantomjs-launcher --save-dev
npm install karma-chrome-launcher --save-dev
npm install grunt-protractor-runner
</pre></div></div>
</div></body></html> 